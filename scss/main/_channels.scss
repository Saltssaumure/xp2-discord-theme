@use "../top/vars" as *;
@use "../top/channel";

.sidebar-1tnWFu .container-1NXEtd {
    background: var(--xp2-background);
    border-left: 1px solid grey;
}

// Mini bar
.container-1-ERn5 {
    .header-3OsQeK,
    .header-3OsQeK:hover {
        background: $tabs-blue;
    }
}

.container-1-ERn5.bannerVisible-Vkyg1I {
    .header-3OsQeK,
    .header-3OsQeK:hover {
        background: transparentize($tabs-blue, 0.3);
    }
}

// Header text
.headerContent-2SNbie {
    color: white;
}

// Special channels (server guide, etc.)
.containerDefault-YUSmu3.wrapper-NhbLHG {
    margin-left: 0;

    .link-1_kTxV {
        padding-left: 16px;
    }
}

// Bring channels/threads closer together while maintaining original height
.wrapper-NhbLHG {
    padding: 0;

    .mainContent-20q_Hp {
        padding: 7px;
    }
}

// Category name
.name-3BUDLf {
    background: var(--xp2-background-2);
    width: fit-content;
    text-transform: none;
}

// Channels
.wrapper-NhbLHG {
    border-radius: 0;
    padding-left: 0;

    // Threads
    .typeThread-2Aqh6X & {
        margin-left: 32px;
        padding-left: 0;
    }
}

// Channel in category
.containerDefault-3TQ5YN ~ .containerDefault-YUSmu3 {
    margin-left: 16px;
}

// Thread in category
.containerDefault-3TQ5YN ~ .container-1Bj0eq {
    margin-left: 24px;
}

.typeThread-2Aqh6X.wrapper-NhbLHG {
    margin-left: 16px;
}

// Remove original spine on threads
.spine-29OFwR,
.spineBorder-1-F4s1 {
    display: none;
}

// Respine time
// Channels in categories, and channels in threadgroups
:is(.containerDefault-3TQ5YN ~ .containerDefault-YUSmu3, .container-1Bj0eq .containerDefault-YUSmu3) .wrapper-NhbLHG::before,
.voiceUser-3nRK-K::before {
    content: "";
    display: block;
    align-self: flex-start;
    $size: 16px;
    width: 8px;
    height: $size;
    position: absolute;
}

// T-shaped spines
// Channels in categories followed by another channel, or a threadgroup and then another channnel
// Channels in threadgroups that are not the last channel
// Users in voice channels that are not the last user
:is(
        .containerDefault-3TQ5YN ~ .containerDefault-YUSmu3:has(+ .containerDefault-YUSmu3, + .container-1Bj0eq + .containerDefault-YUSmu3),
        .container-1Bj0eq .containerDefault-YUSmu3:not(:last-child)
    ) {
    // New spine border
    .wrapper-NhbLHG {
        border-left: 1px dotted grey;

        // New spine
        &::before {
            border-bottom: 1px dotted grey;
        }
    }
}
// Voice user list
.list-2x9Cl9 {
    margin-left: 8px;
    padding-left: 16px;

    // In parent followed by another channel
    .containerDefault-3TQ5YN ~ .containerDefault-YUSmu3:has(+ .containerDefault-YUSmu3) & {
        border-left: 1px dotted grey;
    }
}
// Voice user followed by another user
.voiceUser-3nRK-K:not(.overlap-1yhayD, :last-child) {
    border-left: 1px dotted grey;
    &::before {
        border-bottom: 1px dotted grey;
    }
}

// L-shaped spines
// Channels that are the inversion of the above selector, still in category or threadgroup
:is(
        .containerDefault-3TQ5YN
            ~ .containerDefault-YUSmu3:not(:has(+ .containerDefault-YUSmu3, + .container-1Bj0eq + .containerDefault-YUSmu3)),
        .container-1Bj0eq .containerDefault-YUSmu3:last-child
    ) {
    .wrapper-NhbLHG {
        &::before {
            border: dotted grey;
            border-width: 0 0 1px 1px;
        }
    }
}
.voiceUser-3nRK-K:not(.overlap-1yhayD):last-child {
    &::before {
        border: dotted grey;
        border-width: 0 0 1px 1px;
    }
}

// Thread group spines
.container-1Bj0eq:has(+ .containerDefault-YUSmu3) {
    border-left: 1px dotted grey;
}

// Channel icon
.iconContainer-21RCa3 {
    opacity: 0;
    position: absolute;
    z-index: 1;
    left: 0;
}

// Channel name
.name-28HaxV {
    text-decoration: underline;
    padding: 0 2px;

    // Channel icon
    &::before {
        // Text channels
        @include channel.icon("#", "M5.88657 21", "M14 8", "M5.43309 21", "M15.44 6.99992", "M14.4 7");
        // Announcement channels
        @include channel.icon("⩤", "M19.1 4", "M4.85 8.26445", "M19.0999 3.99994", "M16.6811 5.6591", "M15.84 5.84438");
        // Forum channels
        @include channel.icon("⟰", "M6.56929 14.6869", "M13 4");
        // Voice channels
        @include channel.icon("ᐗ", "M11.383 3.07904", "M15 12");
        // Stage channels
        @include channel.icon("◎", "M14 13", "M15 2.41495");
    }
}

// Selected channel background
.link-1_kTxV {
    .wrapper-NhbLHG:hover &,
    .modeSelected-3DmyhH &,
    .modeSelected-3DmyhH:hover & {
        background: unset;
    }
}
// Selected / connected channel background
.modeSelected-3DmyhH,
.modeSelected-3DmyhH:hover,
.modeConnected-NrO4cP,
.modeConnected-NrO4cP:hover {
    .name-28HaxV {
        background: $tabs-blue;
        color: white;
        font-weight: 500;
        flex: none;
    }
    .children-1MGS9G {
        margin-left: auto;
    }
}

// User area
.panels-3wFtMD {
    height: 52px;

    .container-YkUktl {
        background: $tabs-blue;
        justify-content: space-between;
    }

    .title-338goq,
    .subtext-2HDqJ7 {
        color: white;
    }

    .button-12Fmur:last-child {
        color: white;
        width: auto;
        svg {
            display: none;
        }

        &::before {
            content: "Settings";
            text-decoration: underline;
        }
    }
}
